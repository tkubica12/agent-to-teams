# Microsoft 365 Agents SDK Configuration
# ========================================
# Get these values from your Azure App Registration
# Run 1_create_app_registration.ps1 or check Azure Portal > App Registration

# Connection configuration (parsed by load_configuration_from_env)
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__CLIENTID=your-app-id-here
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__CLIENTSECRET=your-app-secret-here
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__TENANTID=your-tenant-id-here

# Connection mapping - maps all service URLs to SERVICE_CONNECTION
CONNECTIONSMAP_0_SERVICEURL=*
CONNECTIONSMAP_0_CONNECTION=SERVICE_CONNECTION

# Server Configuration
PORT=3978

# Backend API URL (where the Teams agent will forward messages)
BACKEND_API_URL=http://localhost:8000

# OAuth User Authentication Configuration
# ========================================
# Set the OAuth connection name configured in Azure Bot Service
# The connection is created by 2_create_bot_service.ps1 with name "entra"
# This enables the /token command to retrieve user OAuth tokens
AGENTAPPLICATION__USERAUTHORIZATION__HANDLERS__GRAPH__SETTINGS__AZUREBOTOAUTHCONNECTIONNAME=entra

# Note: OAuth token retrieval requires:
# 1. App Registration with redirect URIs, Application ID URI, exposed scope
# 2. Azure Bot Service OAuth connection with tokenExchangeUrl
# 3. Teams app manifest with webApplicationInfo section
# See teams-agent/README.md for setup guide
